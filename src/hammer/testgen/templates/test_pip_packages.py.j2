"""HAMMER Generated Pip Package Tests.

Assignment: {{ assignment_id }}
Phase: {{ phase }}

Tests that verify pip packages are installed.
"""

import pytest


{% for test in tests %}
{% for host in test.hosts %}
@pytest.mark.{{ phase }}
@pytest.mark.weight({{ test.weight }})
def test_pip_{{ test.name | replace("-", "_") }}_{{ test.state }}_on_{{ host }}(host_{{ host }}):
    """Verify pip package {{ test.name }} is {{ test.state }} on {{ host }}."""
    # Use pip show to check if package is installed
    cmd = host_{{ host }}.run("{{ test.python }} -m pip show {{ test.name }}")
{% if test.state == "present" %}
    assert cmd.rc == 0, f"Pip package {{ test.name }} should be installed on {{ host }}"
{% else %}
    assert cmd.rc != 0, f"Pip package {{ test.name }} should not be installed on {{ host }}"
{% endif %}


{% endfor %}
{% endfor %}
